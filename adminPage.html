<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <!-- INCLUDE EXT JS -->
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <!-- ** CSS ** -->
        <!-- base library -->
        <link rel="stylesheet" type="text/css" href="javascript/extjs/resources/css/ext-all.css" />

        <!-- ** Javascript ** -->
        <script src="javascript/namespace.js" type="text/javascript" language="javascript" charset="utf-8"></script>
        <!-- ExtJS library: base/adapter -->
        <script type="text/javascript" src="javascript/extjs/ext-all-debug-w-comments.js"></script>

        <!-- page specific -->
        <script type="text/javascript">
            Ext.BLANK_IMAGE_URL = 'javascript/extjs/resources/themes/images/default/tree/s.gif';
            Ext.require([
                'Ext.form.*',
                'Ext.data.*'
            ]);
            Ext.onReady(function(){
                Ext.regModel('Students', {
                    fields : [
                        {name : "name", type : "string"},
                        {name : "id", type : "integer"}
                    ]
                });

                Leaderboard.ajaxCall = function(parameters, succsess_callback, failure_callback) {
                    Ext.Ajax.request({
                        url : Leaderboard.gateway,
                        success : succsess_callback,
                        failure : failure_callback,
                        params : parameters
                    });
                };

                var students = [];

                var loadSucc = function(response) {
                    students = Ext.decode(response.responseText);
                    console.log(students);
                    Leaderboard.studentsModel = new Ext.create("Ext.data.Store", {
                        model : "Students",
                        data : students
                    });
                    afterLoad();
                }
                
                Leaderboard.ajaxCall({method : "getAllStudents"}, loadSucc);
                 
                var afterLoad = function() {
         
                    console.log(Leaderboard.studentsModel);

                    Leaderboard.addPointsForLecture = Ext.create('Ext.form.FormPanel', {
                        frame: true,
                        title: 'Points for lecture',
                        width: 350,
                        bodyPadding: 5,
                        renderTo : Ext.getBody(),
                        collapsible : true,
                        fieldDefaults: {
                            labelAlign: 'left',
                            labelWidth: 90,
                            anchor: '100%'
                        },

                        items: [{
                                id : 'autocompNames',
                                store : Leaderboard.studentsModel,
                                xtype: 'combo',
                                name: 'nameInput',
                                fieldLabel: 'Name',
                                queryMode: 'local',
                                displayField: 'name',
                                valueField : 'id'
                            },{
                                xtype: 'numberfield',
                                name: 'pointsInput',
                                fieldLabel: 'Points',
                                value: 0.5,
                                step : 0.5,
                                minValue: 0,
                                maxValue: 50
                            },
                            {
                                xtype : 'numberfield',
                                name : 'lectureInput',
                                fieldLabel : 'Lecture',
                                value : 1,
                                step : 1,
                                minValue : 1,
                                maxValue : 20
                            }],
                        buttons : [
                            {
                                text : 'Submit',
                                handler : function() {
                                    // do ajax here
                                    
                                }
                            }
                        ]
                    });
                }

            });
        </script>
        <title>Add points</title>


    </head>

    <body>
    </body>
</html>
